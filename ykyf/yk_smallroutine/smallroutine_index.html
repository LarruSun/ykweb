<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>微信小程序</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="smallroutine_images/logo.png" type="images/logo.png">
    <link rel="stylesheet" href="smallroutine_resources/smallroutine_libcss/bootstrap.min.css" />
    <link rel="stylesheet" href="smallroutine_resources/smallroutine_libcss/font-awesome.min.css" />
    <link rel="stylesheet" href="smallroutine_resources/smallroutine_libcss/ace.min.css" />
    <link rel="stylesheet" href="smallroutine_css/index.css">
    <link rel="stylesheet" href="../resources/plugins/msgbox/msgbox.css">

    <script src="../resources/config.js"></script>
    <script src="smallroutine_resources/smallroutine_lib/jquery.min.js"></script>
    <script src="smallroutine_resources/smallroutine_lib/bootstrap.min.js"></script>
    <script src="smallroutine_resources/smallroutine_lib/ace.min.js"></script>
    <script src="smallroutine_resources/smallroutine_lib/vue.min.js"></script>
    <script src="smallroutine_resources/smallroutine_lib/vue-resource.min.js"></script>
    <script src="smallroutine_js/const.js"></script>
    <script src="smallroutine_resources/smallroutine_plugins/msgbox/msgUtil.js"></script>
    <script src="smallroutine_resources/smallroutine_plugins/msgbox/msgbox.js"></script>

</head>
<style>
    .line{
        display: inline-block;
        width: 200px;
        height: 2px;
        background-color: #000;
        position: relative;
        top: -4px;
        margin:0 10px;
    }
    .line::after{
        content: '';
        position: absolute;
        display: inline-block;
        width: 0;
        height: 0;
        border: 7px solid transparent;
        border-left-color: #000;
        right: -12px;
        top: -6px;
    }

    /*div{
        width: 300px;
        height: 300px;
        border: #000 solid 1px;
        margin: 50px auto;
        overflow: hidden;
    }*/
    .wechat_er img{
        cursor: pointer;
        transition: all 0.6s;
    }
    .wechat_er img:hover{
        transform: scale(2.3);
    }
</style>
<body>
<div id="app" v-cloak>
<div class="navbar navbar-default" id="navbar">
    <headd></headd>
</div>

<!--<div class="navbar navbar-default" id="titleApp">
    <my-component> </my-component>
</div>-->

<div class="main-container" id="main-container">
    <div class="main-container-inner">
        <a class="menu-toggler" id="menu-toggler" href="#">
            <span class="menu-text"></span>
        </a>
        <div class="sidebar" id="sidebar">
            <div>
                <ul class="nav nav-list">
                    <li  class="active">
                        <a href="" class="dropdown-toggle">
                            <i class="icon-desktop"></i>
                            <span class="menu-text"> 小程序管理 </span>
                        </a>
                        <ul class="submenu">
                            <li class="active">
                                <a href="smallroutine_index.html" class="smallroutine_set">
                                    <i class="icon-double-angle-right"></i>
                                    小程序设置
                                </a>
                            </li>
                            <li>
                                <a href="smallroutine_html/home_set.html" class="home_set">
                                    <i class="icon-double-angle-right"></i>
                                    主页设置
                                </a>
                            </li>
                            <li>
                                <a href="smallroutine_html/wechat_shipu.html" class="smallroutine_template">
                                    <i class="icon-double-angle-right"></i>
                                    小程序模板
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul><!-- /.nav-list -->
                <div class="sidebar-collapse" id="sidebar-collapse">
                    <i class="icon-double-angle-left" data-icon1="icon-double-angle-left" data-icon2="icon-double-angle-right"></i>
                </div>
            </div>
        </div>
        <div class="main-content" >
            <div class="breadcrumbs" id="breadcrumbs">
                <ul class="breadcrumb">
                    <li>
                        <i class="icon-home home-icon"></i>
                        <a href="">小程序管理</a>
                    </li>
                    <li>
                        <a href="smallroutine_index.html" class="smallroutine_set">小程序设置</a>
                    </li>
                </ul><!-- .导航 -->
            </div>
            <div class="page-content">
                <div class="row" >
<!--                    <div class="col-xs-12 wxIndex">
                        <div class="boxTop">
                            <div class="boxTop_L">
                                <dl>
                                    <dt><img v-bind:src="app_businessLogo" alt=""></dt>
                                    <dd><b>{{app_businessName}}&nbsp;&nbsp;&nbsp;&nbsp;<span>V{{app_level}}</span></b>
                                        <p>账号：{{app_loginName}}</p>
                                    </dd>
                                </dl>
                            </div>
                            <div class="boxTop_R">
                                <dl>
                                    <dt><img v-bind:src="app_headImg" alt=""></dt>
                                    <dd><b>{{app_nickName}}</b></dd>
                                </dl>
                                <p class="isSQ"><span><img src="smallroutine_images/y.png" alt="">已授权</span></p>
                                <a class="" href="javascript:;" data-toggle="modal" data-target="#myModal_cancle">解除授权</a>
                                <p class="ysl"><img v-bind:src="app_qrcodeUrl" alt=""></p>
                            </div>
                        </div>

                    </div>-->
                    <div class="col-sm-12 Sprogram_Settings">
                        <div class="Sprogram_Settings_one">
                            <div class="wechat_left">
                                <img v-bind:src="app_businessLogo" alt="" class="sogo"/>
                                <div class="wechat_massage">
                                    <p><span>{{app_businessName}}</span><span>V{{app_level}}</span></p>
                                    <p>账号：<span>{{app_loginName}}</span></p>
                                </div>
                            </div>
                            <div class="wechat_right">
                                <div class="wechat_img">
                                    <img v-bind:src="app_headImg" alt=""/>
                                </div>
                                <div class="wechat_massa">
                                    <p>{{app_nickName}}</p>
                                    <p><img src="smallroutine_images/sq.png" alt=""/>已授权</p>
                                </div>
                                <div class="wechat_set">
                                    <!--<a href="#"  data-toggle="modal" data-target="#myModal_rest">重新授权</a>-->
                                    <a href="#"  data-toggle="modal" data-target="#myModal_cancle">解除授权</a>
                                </div>
                                <div class="wechat_er" style="margin-right: 27px;">
                                    <template v-if="app_bindStatu==1 && app_auditStatus==0 && app_qrcodeUrl!=''">
                                    <img v-bind:src="app_qrcodeUrl" alt=""/>    <!--src="smallroutine_images/ewm.png"-->
                                    </template>
                                </div>
                            </div>
                            <div style="clear:both"></div>
                        </div>
                        <div class="Sprogram_Settings_two">
                            <p class="wechat_title">
                                小程序基本信息
                            </p>
                            <div class="wechat_main1">
                                <p>绑定的主页：</p>
                                <p>{{app_pageName}}</p>
                                <a href="./smallroutine_html/home_set.html">绑定</a>
                            </div>
                            <!--<div class="wechat_main2">
                                <p>线上版本：<span>无</span></p>
                                <p>更新时间：<span>2018-02-24 10:30:39</span></p>
                                <div style="display: flex">
                                    <span style="width:100px;">更新状态：</span>
                                    <div>
                                        <p>最新版本（0.0）微信审核失败</p>
                                        <p>失败原因：1:服务类目"餐饮-菜谱_"与你提交代码审核时设置的功能页面内容不一致:<br/>
                                            (1):涉及外卖平台，请登记餐饮-外卖平台类目
                                        </p>
                                        <p>温馨提示：<br/>
                                            <ol>
                                                <li>
                                                    易快小程序都是经过测试验证的，如果审核不通过，可能是微信支付设置有误，或者小程序主页
                                                    相关设置不完善导致，你可以根据微信返回的失败原因，修改设置后重新提交
                                                </li>
                                                <li>
                                                    如果是小程序本身的问题，我们会尽快发布新版本，并自动帮你重新提交
                                                </li>
                                                <li>
                                                    审核失败，并不会影响之前已经在线上运行的老版本小程序
                                                </li>
                                            </ol>
                                        </p>
                                    </div>
                                </div>

                            </div>-->

                                    <div class="wechat_main2" v-if="app_auditStatus==0">
                                        <div class="wechat_two">
                                            <p>线上版本：<span>{{app_version}}</span></p>
                                        </div>
                                        <div class="wechat_three">
                                            <p>更新时间：<span>{{app_checkTime}}</span></p>
                                        </div>
                                        <div class="wechat_four">
                                            <p>更新状态：<span>线上版本是最新版本</span></p>
                                        </div>
                                    </div>


                                    <div class="wechat_main2" v-else-if="app_auditStatus==1">
                                        <div class="wechat_two">
                                            <p>线上版本：<span>{{app_version}}</span></p>
                                        </div>
                                        <div class="wechat_three">
                                            <p>更新时间：<span>{{app_checkTime}}</span></p>
                                        </div>
                                        <div class="wechat_four">
                                            <p>更新状态：</p>
                                            <div style=" margin-left: 78px;margin-top: -34px;">
                                                <p>最新版本（{{app_version}}）微信审核失败</p>
                                                <p>失败原因：{{app_reason}}</p>
                                                <div >
                                                    <p>温馨提示：</p>
                                                    <ol>
                                                        <li>
                                                            易快小程序都是经过测试验证的，如果审核不通过，可能是微信支付设置有误，或者小程序主页
                                                            相关设置不完善导致，你可以根据微信返回的失败原因，修改设置后重新提交
                                                        </li>
                                                        <li>
                                                            如果是小程序本身的问题，我们会尽快发布新版本，并自动帮你重新提交
                                                        </li>
                                                        <li>
                                                            审核失败，并不会影响之前已经在线上运行的老版本小程序
                                                        </li>
                                                    </ol>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="wechat_main2" v-else-if="app_auditStatus==2">
                                        <div class="wechat_two">
                                            <p>线上版本：<span>正在等待微信审核</span></p>
                                        </div>
                                        <div class="wechat_three">
                                            <p>更新时间：<span>无</span></p>
                                        </div>
                                        <div class="wechat_four">
                                            <p>更新状态：<span>无</span></p>
                                        </div>
                                    </div>


                                    <div class="wechat_main2" v-else>
                                        <div class="wechat_two">
                                            <p>线上版本：<span>无</span></p>
                                        </div>
                                        <div class="wechat_three">
                                            <p>更新时间：<span>无</span></p>
                                        </div>
                                        <div class="wechat_four">
                                            <p>更新状态：<span>无</span></p>
                                        </div>
                                    </div>


                        </div>
                        <div class="Sprogram_Settings_three">
                            <p style="border-top:1px solid #ddd;"></p>
                            <div class="wechat_pay2">
                                <p>小程序APPID：<span>{{app_appId}}</span></p>
                                <p>小程序密钥：<span>{{app_appSecret}}</span></p>
                                <a href="#"  data-toggle="modal" data-target="#myModal_set">设置</a>
                            </div>
                        </div>

                        <div class="Sprogram_Settings_three" style="padding: 10px;">
                            <p class="wechat_title">
                                小程序微信支付
                            </p>
                            <div class="wechat-pay-wrap">
                                <label for="" style="width: 150px;">当前微信支付</label>
                                <select name="" id="" v-model="form.isContributing">
                                    <option value="2">请选择</option>
                                    <option value="0">普通商户</option>
                                    <option value="1">签约商户</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px;" v-if="form.isContributing == '1'">
                                请发送文件照片到xxx@qq.com邮箱
                                《食品经营许可证》，《营业执照》，法人身份证照片，对公账户照片，门店地址
                                邮件标题：XXX-开通签约商户
                                <div style="margin-top: 10px;">
                                    <span :style="{ 'color' : verityStep == '0' ? '#ff0000' : '#000' }">发邮件</span>
                                    <div class="line"></div>
                                    <span :style="{ 'color' : (verityStep == '1' || verityStep == '2') ? '#ff0000' : '#000' }">{{ verityStep == 1 ? '审核中' : verityStep == 2 ? '审核失败' : '审核成功'  }}</span>
                                    <div class="line"></div>
                                    <span :style="{ 'color' : verityStep == '3' ? '#ff0000' : '#000' }">完成</span>
                                </div>
                                <button class="btn btn-primary" @click="savePaySetting" style="margin-top: 10px;">确认已发邮件</button>
                            </div>
                            <div v-if="form.isContributing == '0'">
                                <div style="margin-top: 20px;">

                                    <label for="" style="width: 150px;">微信商户ID</label><input type="text" v-model="form.mchId">
                                </div>
                                <div style="margin-top: 20px;">

                                    <label for="" style="width: 150px;">微信商户APP秘钥</label><input type="text" v-model="form.apikey">
                                </div>
                                <div style="margin-top: 20px;">

                                    <label for="" style="width: 150px;">P12证书上传</label>
                                    <input type="file" @change="inputFile" style="display: inline-block" accept="application/x-pkcs12">
                                </div>
                                <div style="margin-top: 20px;">
                                    <button class="btn btn-primary" @click="savePaySetting">保存</button>
                                    <button class="btn btn-primary" @click="test">测试</button>
                                </div>
                            </div>
                        </div>
                        <div style="clear:both"></div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="myModal_set" tabindex="-1" role="dialog" aria-labelledby="myModalLabel_out2" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
                            </button>
                            <h4 class="modal-title">
                                微信支付配置
                            </h4>
                        </div>
                        <div class="modal-body ">
                            <div class="scroll_name">
                                <div class="">
                                    <label>
                                        <span class="lbl font_size">小程序APPID：</span>
                                        <input placeholder="" style="    margin-left: 14px;" v-model="model_appId">
                                    </label>
                                    <p style="color: #999;font-size: 12px;margin-left: 74px">微信支付审核通过后，微信会将商户号发送到接收邮箱</p>
                                </div>
                                <div class="" style="    margin-top: 18px;">
                                    <label>
                                        <span class="lbl font_size" >小程序密钥：</span>
                                        <input placeholder="" v-model="model_appSecret">
                                    </label>
                                    <p style="color: #999;font-size: 12px;margin-left: 74px">请登录微信商户平台，进入<span style="color:#00aeef">「账户中心-API安全」</span>>页面，设置密钥 查看教程</p>
                                </div>
                                <div class="" style="margin-top: 18px;margin-bottom: 39px;">
                                    <div style=" ">
                                        <div style="  margin-top: -3px;margin-left: 75px;">
                                            <label for="text" class=" control-label" style=" ">
                                                <input class="ace clickAll isGreePro" type="checkbox" v-on:click="changeCheck">
                                                <span class="lbl" style="color:#555;">已确认商户号和商户密钥配置正确（否则将导致微信支付异常，小程序无法通过审核）</span>
                                            </label>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                            </button>
                            <button type="button" class="btn disabled" data-dismiss="modal" v-on:click="saveWxConfig" id="sureBtn">
                                确定
                            </button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div>

            <!--解除授权 start-->
            <div class="modal fade" id="myModal_cancle" tabindex="-1" role="dialog" aria-labelledby="myModalLabel_out2" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                            <h4 class="modal-title" id="myModalLabel_out2">解除授权</h4>
                        </div>
                        <div class="modal-body ">
                            <div class="scroll_name">
                                <p style="text-align:center;font-size:16px;">是否需要继续解除授权?</p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" v-on:click="delAuthorize">确定</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div>
            <!--解除授权 end-->

            <div class="modal fade in" id="myModal_rest" tabindex="-1" role="dialog" aria-labelledby="myModalLabel_out2" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                            <h4 class="modal-title" >重新授权</h4>
                        </div>
                        <div class="modal-body ">
                            <div class="scroll_name">
                                <p style="text-align:center;font-size:16px;" class="restMessage">是否需要继续重新授权！</p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                            <button type="button" class="btn btn-primary choose" data-dismiss="modal">确定</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div>

        </div> <!--<div class="main-content" id="app">-->

    </div><!-- /.main-container-inner -->
</div><!-- /.main-content -->
<!--置顶图标 start-->
<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
    <i class="icon-double-angle-up icon-only bigger-110"></i>
</a>
<!--置顶图标 end-->
</div>

</body>

<script>
    /*$(function(){
        $(".sended_banBox .sended_item .item_div2 b").hover(function(){
            $(this).next().show();
        },function(){
            $(this).next().hide();
        })
    })*/


    new Vue({
        el: '#app',
        data: {
            pathVue:pathVue,
            smallroutine_set_href:'',
            app_nickName:'',
            app_qrcodeUrl:'',
            app_headImg:'',
            app_businessLogo:'',
            app_businessName:'',
            app_loginName:'',
            app_level:'',
            app_userId:'',
            app_platform:'ykyf',
            app_auditStatus:-1,
            app_appId:'无',
            app_appSecret:'无',
            app_pageName:'无',

            app_version:'无',
            app_checkTime:'无',
            app_reason:'无',
            app_bindStatu:'',

            model_appSecret:'',
            model_appId:'',
            form : {
                isContributing: '0'
            },
            payFile: {},
            verityStep: '1',
            isTest: true,
        },
        methods:{
            delAuthorize:function(){
                if(this.userId!=''){
                    if(this.app_auditStatus==2){
                        alertErrors("小程序正在审核中，无法解除绑定",2000);
                        return false;
                    }
                    this.$http.post(pathApi+"/wx/smallRoutine/delWxThirdPartyPlatform",
                        {userId:this.app_userId},
                        {emulateJSON:true,credentials: true}).then(function(res){
                            console.log(res);
                            if(res.data.type=="success"){
                                //location.href=pathApi+'/wx/smallRoutine/toSmallRoutine?userId='+this.app_userId+'&platform='+this.app_platform;
                                location.href=this.smallroutine_set_href;
                            }else{
                                alertErrors(res.data.message,2000);
                            }
                    });
                }
            },
            changeCheck:function(){
                var isPro=$(".isGreePro").prop("checked");
                if(isPro){
                    $("#sureBtn").removeClass("disabled").addClass("btn-primary");
                }else{
                    $("#sureBtn").removeClass("btn-primary").addClass("disabled");
                }
            },
            saveWxConfig:function(e){
                var dom=e.target;
                if($(dom).hasClass("disabled")){
                    return false;
                }
                var param={};
                if(this.model_appId==''){
                    alertErrors("请输入小程序APPID",1500);
                    return false;
                }else{
                    param.appId=this.model_appId;
                }
                if(this.model_appSecret==''){
                    alertErrors("请输入小程序密钥",1500);
                    return false;
                }else{
                    param.appSecret=this.model_appSecret;
                }
                param.userId=this.app_userId;

                this.$http.post(pathApi+"/smallroutine/smallRoutineSet/add/saveWxConfig",param,
                    {emulateJSON:true,credentials: true}).then(function(res){
                    console.log(res);
                    if(res.data.type=="success"){
                        alertSuccess(res.data.message,2000);
                        location.href=this.smallroutine_set_href;
                    }else{
                        alertErrors(res.data.message,2000);
                    }
                });

            },
            inputFile(val) {
                let file = event.target.files;
                if ( file[0] != null ){
                    if(file[0].type != "application/x-pkcs12"){
                        alert('请上传正确的证书文件');
                        return false
                    }else {
                        this.inputFile = file[0];
                    }
                   /* let reader = new FileReader();
                    reader.readAsDataURL(file[0]);
                    reader.onload = ()=> {
                        this.backUrl = reader.result;
                    };
                    lrz(file[0]).then(res => {
                        res.file.name = res.origin.name;
                    this.formData.file = res.file;
                    })*/
                }
            },
            savePaySetting() {
                let formData = new FormData();
                for(let k in this.form) {
                    formData.append(k, this.form[k]);
                }
                formData.append('certUrl',this.inputFile);
                this.$http.post(pathApi+"/pay/pay/expay/saveWxPay",formData,{emulateJSON:true,credentials: true}).then(function(res){
                    if(res.data.type=="success"){
                        this.isTest = false;
                        alert(res.data.message);
                    }else{
                        alert(res.data.message);
                    }
                });
            },
            test() {
                this.$http.get(pathApi + '/pay/pay/expay/testWxPay',{emulateJSON:true,credentials: true}).then(res => {
                    if(res.data.type=="success"){
                        alert("测试成功");
                    }else {
                        alert(res.data.message);
                    }
                })
            }
        },

        created:function() {
            //var userId = location.search;
            //var param={};
            /*if (userId.indexOf("?") != -1) {
                var str = userId.substr(1);
                param.userId=str.split("_")[0].split("=")[1];
                param.platform=str.split("_")[1];

                this.app_userId=param.userId;
                this.app_platform=param.platform;
            }*/
            //console.log(param);
            //this.$http.post(pathApi+"/smallroutine/smallRoutineSet/getSmallRoutineSet",param,
            alertLoading("正在加载中，请稍后...",60000);
            this.$http.post(pathApi+"/smallroutine/smallRoutineSet/get/getSmallRoutineSet",{},
                {emulateJSON:true,credentials: true}).then(function(res){
            //this.$http.get(pathApi+'/wx/weChat/getWechatData?userId='+userId,{emulateJSON:true,credentials: true}).then(function(res){
                console.log(res);
                alertHide();
                if(res.data.type=="fail"){
                    alertErrors(res.data.message,2000);
                }else{
                    console.log(res.data.data);
                    var wxThirdPartyPlatform=res.data.data.wxThirdPartyPlatUser.wxThirdPartyPlatform;
                    var users=res.data.data.users;
                    var wxConfig=res.data.data.wxConfig;
                    var wxUserSmallRoutine=res.data.data.wxUserSmallRoutine;
                    var pageName=res.data.data.pageName;
                    var auditStatus=res.data.data.auditStatus;

                    if(pageName!=undefined)
                        this.app_pageName=pageName;
                    this.app_businessLogo=users.businessLogo;
                    this.app_businessName=users.nickName;
                    this.app_loginName=users.loginName;
                    this.app_level=users.level;
                    this.app_userId=users.id;
                    this.smallroutine_set_href=pathApi+'/wx/smallRoutine/toSmallRoutine?userId='+this.app_userId+'&platform='+this.app_platform;

                    if(wxThirdPartyPlatform==null){
                        location.href=this.smallroutine_set_href;
                    }

                    this.app_nickName=wxThirdPartyPlatform.nickName;
                    this.app_qrcodeUrl=wxThirdPartyPlatform.qrcodeUrl;
                    this.app_headImg=wxThirdPartyPlatform.headImg;

                    $(".user_name").html(this.app_businessName);
                    if(this.app_businessLogo!=''){
                        $(".nav-user-photo").attr("src",this.app_businessLogo);
                    }

                    if(pageName!=null && pageName!=''){
                        this.pageName=pageName;
                    }

                    if(auditStatus!=null){
                        this.app_auditStatus=auditStatus.status;
                        this.app_reason=auditStatus.reason;
                    }

                    if(wxUserSmallRoutine!=null){
                        this.app_version=wxUserSmallRoutine.version;
                        this.app_checkTime=wxUserSmallRoutine.checkTime;
                        this.app_bindStatu=wxUserSmallRoutine.bindStatu;
                    }

                    if(wxConfig!=null){
                        this.app_appId=wxConfig.appId;
                        this.app_appSecret=wxConfig.appSecret;
                    }
                }
            });
            this.$http.get(pathApi + '/pay/pay/expay/selWxPay',{emulateJSON:true,credentials: true}).then(res => {
                if(res.data.type == 'success'){
                    if(res.data.data == null || res.data.data == 'undefined') {
                        this.form.isContributing = "2";
                    }else {
                        this.form.appid = res.data.data.appid;
                        this.form.mchId = res.data.data.mch_id;
                        this.form.isContributing = res.data.data.contributing ? '1' : '0';
                        this.form.apikey = res.data.data.paykey;
                        this.verityStep = res.data.data.verityStep;
                    }
                }
            })
        }
    });
</script>
</html>
